## [CVE-2021-24499](https://nvd.nist.gov/vuln/detail/CVE-2021-24499)
## [Exploit-db](https://www.exploit-db.com/exploits/51510)

## [Vendor](https://themeforest.net/item/workreap-freelance-marketplace-wordpress-theme/23712454)

## Description:
The Workreap WordPress theme before 2.2.2 AJAX actions workreap_award_temp_file_uploader and workreap_temp_file_uploader did not perform nonce checks, or validate that the request is from a valid user in any other way. The endpoints allowed for uploading arbitrary files to the uploads/workreap-temp directory. Uploaded files were neither sanitized nor validated, allowing an unauthenticated visitor to upload executable code such as php scripts.

## code workflow

- The code performs the following steps:
    - Imports necessary modules and defines helper functions.
    - Handles the file upload process by constructing a URL for the target site's AJAX endpoint and uploading a PHP payload file.
    - Checks if the uploaded PHP file executed successfully by sending a GET request and searching for a specific random string.
    - Prompts the user to proceed with remote code execution (RCE) if the PHP file executed successfully.
    - Creates a new PHP shell payload, uploads it, and allows the user to execute commands on the target system.


## Usage
```cmd
python3 CVE-2021-24499.py https://domain.tld
python CVE-2021-24499.py https://domain.tld
```


